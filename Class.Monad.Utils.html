<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Class.Monad.Utils</title><link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/github-fork-ribbon-css/0.2.3/gh-fork-ribbon.min.css'/><style>.github-fork-ribbon:before { background-color: #333; }</style><link rel="stylesheet" href="css/Agda.css"></head><body><a class='github-fork-ribbon'href='https://github.com/omelkonian/stdlib-meta/tree/tactics/Class/Monad/Utils.agda'data-ribbon='Source code on Github' title='Source code on Github'>Source code on Github</a><pre class="Agda"><a id="1" class="Comment">------------------------</a>
<a id="26" class="Comment">-- ** Monadic utilities.</a>

<a id="52" class="Symbol">{-#</a> <a id="56" class="Keyword">OPTIONS</a> <a id="64" class="Pragma">--safe</a> <a id="71" class="Pragma">--without-K</a> <a id="83" class="Symbol">#-}</a>
<a id="87" class="Keyword">open</a> <a id="92" class="Keyword">import</a> <a id="99" href="Agda.Primitive.html" class="Module">Agda.Primitive</a> <a id="114" class="Keyword">using</a> <a id="120" class="Symbol">()</a> <a id="123" class="Keyword">renaming</a> <a id="132" class="Symbol">(</a><a id="133" href="Agda.Primitive.html#326" class="Primitive">Set</a> <a id="137" class="Symbol">to</a> <a id="140" class="Primitive">Type</a><a id="144" class="Symbol">)</a>
<a id="146" class="Keyword">open</a> <a id="151" class="Keyword">import</a> <a id="158" href="Level.html" class="Module">Level</a> <a id="164" class="Keyword">using</a> <a id="170" class="Symbol">(</a><a id="171" href="Agda.Primitive.html#597" class="Postulate">Level</a><a id="176" class="Symbol">)</a>
<a id="178" class="Keyword">open</a> <a id="183" class="Keyword">import</a> <a id="190" href="Function.html" class="Module">Function</a> <a id="199" class="Keyword">using</a> <a id="205" class="Symbol">(</a><a id="206" href="Function.Base.html#1031" class="Function Operator">_∘_</a><a id="209" class="Symbol">)</a>

<a id="212" class="Keyword">open</a> <a id="217" class="Keyword">import</a> <a id="224" href="Data.Unit.html" class="Module">Data.Unit</a> <a id="234" class="Keyword">using</a> <a id="240" class="Symbol">(</a><a id="241" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a><a id="242" class="Symbol">;</a> <a id="244" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a><a id="246" class="Symbol">)</a>
<a id="248" class="Keyword">open</a> <a id="253" class="Keyword">import</a> <a id="260" href="Data.Bool.html" class="Module">Data.Bool</a> <a id="270" class="Keyword">using</a> <a id="276" class="Symbol">(</a><a id="277" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="281" class="Symbol">;</a> <a id="283" href="Data.Bool.Base.html#1283" class="Function Operator">if_then_else_</a><a id="296" class="Symbol">;</a> <a id="298" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a><a id="302" class="Symbol">;</a> <a id="304" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a><a id="309" class="Symbol">)</a>
<a id="311" class="Keyword">open</a> <a id="316" class="Keyword">import</a> <a id="323" href="Data.List.html" class="Module">Data.List</a> <a id="333" class="Keyword">using</a> <a id="339" class="Symbol">(</a><a id="340" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="344" class="Symbol">;</a> <a id="346" href="Data.List.Base.html#10383" class="InductiveConstructor">[]</a><a id="348" class="Symbol">;</a> <a id="350" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷_</a><a id="353" class="Symbol">;</a> <a id="355" href="Data.List.Base.html#4394" class="Function">concat</a><a id="361" class="Symbol">;</a> <a id="363" href="Data.List.Base.html#5025" class="Function Operator">[_]</a><a id="366" class="Symbol">;</a> <a id="368" href="Data.List.Base.html#1810" class="Function Operator">_++_</a><a id="372" class="Symbol">)</a>
<a id="374" class="Keyword">open</a> <a id="379" class="Keyword">import</a> <a id="386" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="397" class="Keyword">using</a> <a id="403" class="Symbol">(</a><a id="404" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a><a id="409" class="Symbol">;</a> <a id="411" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a><a id="415" class="Symbol">;</a> <a id="417" href="Data.Maybe.Base.html#1632" class="Function">fromMaybe</a><a id="426" class="Symbol">)</a>

<a id="429" class="Keyword">open</a> <a id="434" class="Keyword">import</a> <a id="441" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="479" class="Keyword">using</a> <a id="485" class="Symbol">(</a><a id="486" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_≡_</a><a id="489" class="Symbol">;</a> <a id="491" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="495" class="Symbol">)</a>

<a id="498" class="Keyword">open</a> <a id="503" class="Keyword">import</a> <a id="510" href="Class.Functor.Core.html" class="Module">Class.Functor.Core</a>
<a id="529" class="Keyword">open</a> <a id="534" class="Keyword">import</a> <a id="541" href="Class.Applicative.Core.html" class="Module">Class.Applicative.Core</a>
<a id="564" class="Keyword">open</a> <a id="569" class="Keyword">import</a> <a id="576" href="Class.Applicative.Instances.html" class="Module">Class.Applicative.Instances</a>
<a id="604" class="Keyword">open</a> <a id="609" class="Keyword">import</a> <a id="616" href="Class.Monad.Core.html" class="Module">Class.Monad.Core</a>
<a id="633" class="Keyword">open</a> <a id="638" class="Keyword">import</a> <a id="645" href="Class.Monad.Instances.html" class="Module">Class.Monad.Instances</a>

<a id="668" class="Keyword">module</a> <a id="675" href="Class.Monad.Utils.html" class="Module">Class.Monad.Utils</a> <a id="693" class="Symbol">{</a><a id="694" href="Class.Monad.Utils.html#694" class="Bound">M</a> <a id="696" class="Symbol">:</a> <a id="698" href="Class.Functor.Core.html#573" class="Function">Type↑</a><a id="703" class="Symbol">}</a> <a id="705" class="Symbol">⦃</a> <a id="707" href="Class.Monad.Utils.html#707" class="Bound">_</a> <a id="709" class="Symbol">:</a> <a id="711" href="Class.Monad.Core.html#608" class="Record">Monad</a> <a id="717" href="Class.Monad.Utils.html#694" class="Bound">M</a> <a id="719" class="Symbol">⦄</a> <a id="721" class="Keyword">where</a>

<a id="728" class="Keyword">private</a> <a id="736" class="Keyword">variable</a>
  <a id="747" href="Class.Monad.Utils.html#747" class="Generalizable">ℓ</a> <a id="749" href="Class.Monad.Utils.html#749" class="Generalizable">ℓ′</a> <a id="752" href="Class.Monad.Utils.html#752" class="Generalizable">ℓ″</a> <a id="755" class="Symbol">:</a> <a id="757" href="Agda.Primitive.html#597" class="Postulate">Level</a>
  <a id="765" href="Class.Monad.Utils.html#765" class="Generalizable">A</a> <a id="767" class="Symbol">:</a> <a id="769" href="Class.Monad.Utils.html#140" class="Primitive">Type</a> <a id="774" href="Class.Monad.Utils.html#747" class="Generalizable">ℓ</a><a id="775" class="Symbol">;</a> <a id="777" href="Class.Monad.Utils.html#777" class="Generalizable">B</a> <a id="779" class="Symbol">:</a> <a id="781" href="Class.Monad.Utils.html#140" class="Primitive">Type</a> <a id="786" href="Class.Monad.Utils.html#749" class="Generalizable">ℓ′</a><a id="788" class="Symbol">;</a> <a id="790" href="Class.Monad.Utils.html#790" class="Generalizable">C</a> <a id="792" class="Symbol">:</a> <a id="794" href="Class.Monad.Utils.html#140" class="Primitive">Type</a> <a id="799" href="Class.Monad.Utils.html#752" class="Generalizable">ℓ″</a>

<a id="mapM"></a><a id="803" href="Class.Monad.Utils.html#803" class="Function">mapM</a> <a id="808" class="Symbol">:</a> <a id="810" class="Symbol">(</a><a id="811" href="Class.Monad.Utils.html#765" class="Generalizable">A</a> <a id="813" class="Symbol">→</a> <a id="815" href="Class.Monad.Utils.html#694" class="Bound">M</a> <a id="817" href="Class.Monad.Utils.html#777" class="Generalizable">B</a><a id="818" class="Symbol">)</a> <a id="820" class="Symbol">→</a> <a id="822" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="827" href="Class.Monad.Utils.html#765" class="Generalizable">A</a> <a id="829" class="Symbol">→</a> <a id="831" href="Class.Monad.Utils.html#694" class="Bound">M</a> <a id="833" class="Symbol">(</a><a id="834" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="839" href="Class.Monad.Utils.html#777" class="Generalizable">B</a><a id="840" class="Symbol">)</a>
<a id="842" href="Class.Monad.Utils.html#803" class="Function">mapM</a> <a id="847" href="Class.Monad.Utils.html#847" class="Bound">f</a> <a id="849" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>       <a id="858" class="Symbol">=</a> <a id="860" href="Class.Monad.Core.html#756" class="Field">return</a> <a id="867" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
<a id="870" href="Class.Monad.Utils.html#803" class="Function">mapM</a> <a id="875" href="Class.Monad.Utils.html#875" class="Bound">f</a> <a id="877" class="Symbol">(</a><a id="878" href="Class.Monad.Utils.html#878" class="Bound">x</a> <a id="880" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="882" href="Class.Monad.Utils.html#882" class="Bound">xs</a><a id="884" class="Symbol">)</a> <a id="886" class="Symbol">=</a> <a id="888" class="Symbol">⦇</a> <a id="890" href="Class.Monad.Utils.html#875" class="Bound">f</a> <a id="892" href="Class.Monad.Utils.html#878" class="Bound">x</a> <a id="894" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="896" href="Class.Monad.Utils.html#803" class="Function">mapM</a> <a id="901" href="Class.Monad.Utils.html#875" class="Bound">f</a> <a id="903" href="Class.Monad.Utils.html#882" class="Bound">xs</a> <a id="906" class="Symbol">⦈</a>

<a id="concatMapM"></a><a id="909" href="Class.Monad.Utils.html#909" class="Function">concatMapM</a> <a id="920" class="Symbol">:</a> <a id="922" class="Symbol">(</a><a id="923" href="Class.Monad.Utils.html#765" class="Generalizable">A</a> <a id="925" class="Symbol">→</a> <a id="927" href="Class.Monad.Utils.html#694" class="Bound">M</a> <a id="929" class="Symbol">(</a><a id="930" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="935" href="Class.Monad.Utils.html#777" class="Generalizable">B</a><a id="936" class="Symbol">))</a> <a id="939" class="Symbol">→</a> <a id="941" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="946" href="Class.Monad.Utils.html#765" class="Generalizable">A</a> <a id="948" class="Symbol">→</a> <a id="950" href="Class.Monad.Utils.html#694" class="Bound">M</a> <a id="952" class="Symbol">(</a><a id="953" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="958" href="Class.Monad.Utils.html#777" class="Generalizable">B</a><a id="959" class="Symbol">)</a>
<a id="961" href="Class.Monad.Utils.html#909" class="Function">concatMapM</a> <a id="972" href="Class.Monad.Utils.html#972" class="Bound">f</a> <a id="974" href="Class.Monad.Utils.html#974" class="Bound">xs</a> <a id="977" class="Symbol">=</a> <a id="979" href="Data.List.Base.html#4394" class="Function">concat</a> <a id="986" href="Class.Functor.Core.html#707" class="Field Operator">&lt;$&gt;</a> <a id="990" href="Class.Monad.Utils.html#803" class="Function">mapM</a> <a id="995" href="Class.Monad.Utils.html#972" class="Bound">f</a> <a id="997" href="Class.Monad.Utils.html#974" class="Bound">xs</a>

<a id="forM"></a><a id="1001" href="Class.Monad.Utils.html#1001" class="Function">forM</a> <a id="1006" class="Symbol">:</a> <a id="1008" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1013" href="Class.Monad.Utils.html#765" class="Generalizable">A</a> <a id="1015" class="Symbol">→</a> <a id="1017" class="Symbol">(</a><a id="1018" href="Class.Monad.Utils.html#765" class="Generalizable">A</a> <a id="1020" class="Symbol">→</a> <a id="1022" href="Class.Monad.Utils.html#694" class="Bound">M</a> <a id="1024" href="Class.Monad.Utils.html#777" class="Generalizable">B</a><a id="1025" class="Symbol">)</a> <a id="1027" class="Symbol">→</a> <a id="1029" href="Class.Monad.Utils.html#694" class="Bound">M</a> <a id="1031" class="Symbol">(</a><a id="1032" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1037" href="Class.Monad.Utils.html#777" class="Generalizable">B</a><a id="1038" class="Symbol">)</a>
<a id="1040" href="Class.Monad.Utils.html#1001" class="Function">forM</a> <a id="1045" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>       <a id="1054" class="Symbol">_</a> <a id="1056" class="Symbol">=</a> <a id="1058" href="Class.Monad.Core.html#756" class="Field">return</a> <a id="1065" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
<a id="1068" href="Class.Monad.Utils.html#1001" class="Function">forM</a> <a id="1073" class="Symbol">(</a><a id="1074" href="Class.Monad.Utils.html#1074" class="Bound">x</a> <a id="1076" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1078" href="Class.Monad.Utils.html#1078" class="Bound">xs</a><a id="1080" class="Symbol">)</a> <a id="1082" href="Class.Monad.Utils.html#1082" class="Bound">f</a> <a id="1084" class="Symbol">=</a> <a id="1086" class="Symbol">⦇</a> <a id="1088" href="Class.Monad.Utils.html#1082" class="Bound">f</a> <a id="1090" href="Class.Monad.Utils.html#1074" class="Bound">x</a> <a id="1092" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1094" href="Class.Monad.Utils.html#1001" class="Function">forM</a> <a id="1099" href="Class.Monad.Utils.html#1078" class="Bound">xs</a> <a id="1102" href="Class.Monad.Utils.html#1082" class="Bound">f</a> <a id="1104" class="Symbol">⦈</a>

<a id="concatForM"></a><a id="1107" href="Class.Monad.Utils.html#1107" class="Function">concatForM</a> <a id="1118" class="Symbol">:</a> <a id="1120" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1125" href="Class.Monad.Utils.html#765" class="Generalizable">A</a> <a id="1127" class="Symbol">→</a> <a id="1129" class="Symbol">(</a><a id="1130" href="Class.Monad.Utils.html#765" class="Generalizable">A</a> <a id="1132" class="Symbol">→</a> <a id="1134" href="Class.Monad.Utils.html#694" class="Bound">M</a> <a id="1136" class="Symbol">(</a><a id="1137" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1142" href="Class.Monad.Utils.html#777" class="Generalizable">B</a><a id="1143" class="Symbol">))</a> <a id="1146" class="Symbol">→</a> <a id="1148" href="Class.Monad.Utils.html#694" class="Bound">M</a> <a id="1150" class="Symbol">(</a><a id="1151" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1156" href="Class.Monad.Utils.html#777" class="Generalizable">B</a><a id="1157" class="Symbol">)</a>
<a id="1159" href="Class.Monad.Utils.html#1107" class="Function">concatForM</a> <a id="1170" href="Class.Monad.Utils.html#1170" class="Bound">xs</a> <a id="1173" href="Class.Monad.Utils.html#1173" class="Bound">f</a> <a id="1175" class="Symbol">=</a> <a id="1177" href="Data.List.Base.html#4394" class="Function">concat</a> <a id="1184" href="Class.Functor.Core.html#707" class="Field Operator">&lt;$&gt;</a> <a id="1188" href="Class.Monad.Utils.html#1001" class="Function">forM</a> <a id="1193" href="Class.Monad.Utils.html#1170" class="Bound">xs</a> <a id="1196" href="Class.Monad.Utils.html#1173" class="Bound">f</a>

<a id="return⊤"></a><a id="1199" href="Class.Monad.Utils.html#1199" class="Function">return⊤</a> <a id="void"></a><a id="1207" href="Class.Monad.Utils.html#1207" class="Function">void</a> <a id="1212" class="Symbol">:</a> <a id="1214" href="Class.Monad.Utils.html#694" class="Bound">M</a> <a id="1216" href="Class.Monad.Utils.html#765" class="Generalizable">A</a> <a id="1218" class="Symbol">→</a> <a id="1220" href="Class.Monad.Utils.html#694" class="Bound">M</a> <a id="1222" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="1224" href="Class.Monad.Utils.html#1199" class="Function">return⊤</a> <a id="1232" href="Class.Monad.Utils.html#1232" class="Bound">k</a> <a id="1234" class="Symbol">=</a> <a id="1236" href="Class.Monad.Utils.html#1232" class="Bound">k</a> <a id="1238" href="Class.Monad.Core.html#933" class="Function Operator">≫</a> <a id="1240" href="Class.Monad.Core.html#756" class="Field">return</a> <a id="1247" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>
<a id="1250" href="Class.Monad.Utils.html#1207" class="Function">void</a> <a id="1255" class="Symbol">=</a> <a id="1257" href="Class.Monad.Utils.html#1199" class="Function">return⊤</a>

<a id="filterM"></a><a id="1266" href="Class.Monad.Utils.html#1266" class="Function">filterM</a> <a id="1274" class="Symbol">:</a> <a id="1276" class="Symbol">(</a><a id="1277" href="Class.Monad.Utils.html#765" class="Generalizable">A</a> <a id="1279" class="Symbol">→</a> <a id="1281" href="Class.Monad.Utils.html#694" class="Bound">M</a> <a id="1283" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="1287" class="Symbol">)</a> <a id="1289" class="Symbol">→</a> <a id="1291" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1296" href="Class.Monad.Utils.html#765" class="Generalizable">A</a> <a id="1298" class="Symbol">→</a> <a id="1300" href="Class.Monad.Utils.html#694" class="Bound">M</a> <a id="1302" class="Symbol">(</a><a id="1303" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1308" href="Class.Monad.Utils.html#765" class="Generalizable">A</a><a id="1309" class="Symbol">)</a>
<a id="1311" href="Class.Monad.Utils.html#1266" class="Function">filterM</a> <a id="1319" class="Symbol">_</a> <a id="1321" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="1324" class="Symbol">=</a> <a id="1326" href="Class.Monad.Core.html#756" class="Field">return</a> <a id="1333" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
<a id="1336" href="Class.Monad.Utils.html#1266" class="Function">filterM</a> <a id="1344" href="Class.Monad.Utils.html#1344" class="Bound">p</a> <a id="1346" class="Symbol">(</a><a id="1347" href="Class.Monad.Utils.html#1347" class="Bound">x</a> <a id="1349" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1351" href="Class.Monad.Utils.html#1351" class="Bound">xs</a><a id="1353" class="Symbol">)</a> <a id="1355" class="Symbol">=</a> <a id="1357" class="Keyword">do</a>
  <a id="1362" href="Class.Monad.Utils.html#1362" class="Bound">b</a> <a id="1364" href="Class.Monad.Core.html#777" class="Field Operator">←</a> <a id="1366" href="Class.Monad.Utils.html#1344" class="Bound">p</a> <a id="1368" href="Class.Monad.Utils.html#1347" class="Bound">x</a>
  <a id="1372" class="Symbol">((</a><a id="1374" href="Data.Bool.Base.html#1283" class="Function Operator">if</a> <a id="1377" href="Class.Monad.Utils.html#1362" class="Bound">b</a> <a id="1379" href="Data.Bool.Base.html#1283" class="Function Operator">then</a> <a id="1384" href="Data.List.Base.html#5025" class="Function Operator">[</a> <a id="1386" href="Class.Monad.Utils.html#1347" class="Bound">x</a> <a id="1388" href="Data.List.Base.html#5025" class="Function Operator">]</a> <a id="1390" href="Data.Bool.Base.html#1283" class="Function Operator">else</a> <a id="1395" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="1397" class="Symbol">)</a> <a id="1399" href="Data.List.Base.html#1810" class="Function Operator">++_</a><a id="1402" class="Symbol">)</a> <a id="1404" href="Class.Functor.Core.html#707" class="Field Operator">&lt;$&gt;</a> <a id="1408" href="Class.Monad.Utils.html#1266" class="Function">filterM</a> <a id="1416" href="Class.Monad.Utils.html#1344" class="Bound">p</a> <a id="1418" href="Class.Monad.Utils.html#1351" class="Bound">xs</a>

<a id="1422" class="Comment">-- traverse : ∀ {A B : Type} {M : Type → Type} → ⦃ Applicative M ⦄ → ⦃ Monad M ⦄ → (A → M B) → List A → M (List B)</a>
<a id="1537" class="Comment">-- traverse f = λ where</a>
<a id="1561" class="Comment">--   [] → return []</a>
<a id="1581" class="Comment">--   (x ∷ xs) → ⦇ f x ∷ traverse f xs ⦈</a>

<a id="do-pure"></a><a id="1622" href="Class.Monad.Utils.html#1622" class="Function">do-pure</a> <a id="1630" class="Symbol">:</a> <a id="1632" class="Symbol">∀</a> <a id="1634" class="Symbol">{</a><a id="1635" href="Class.Monad.Utils.html#1635" class="Bound">A</a> <a id="1637" class="Symbol">:</a> <a id="1639" href="Class.Monad.Utils.html#140" class="Primitive">Type</a> <a id="1644" href="Class.Monad.Utils.html#747" class="Generalizable">ℓ</a><a id="1645" class="Symbol">}</a> <a id="1647" class="Symbol">{</a><a id="1648" href="Class.Monad.Utils.html#1648" class="Bound">x</a> <a id="1650" class="Symbol">:</a> <a id="1652" href="Class.Monad.Utils.html#1635" class="Bound">A</a><a id="1653" class="Symbol">}</a> <a id="1655" class="Symbol">{</a><a id="1656" href="Class.Monad.Utils.html#1656" class="Bound">mx</a> <a id="1659" class="Symbol">:</a> <a id="1661" href="Agda.Builtin.Maybe.html#136" class="Datatype">Maybe</a> <a id="1667" href="Class.Monad.Utils.html#1635" class="Bound">A</a><a id="1668" class="Symbol">}</a> <a id="1670" class="Symbol">{</a><a id="1671" href="Class.Monad.Utils.html#1671" class="Bound">f</a> <a id="1673" class="Symbol">:</a> <a id="1675" href="Class.Monad.Utils.html#1635" class="Bound">A</a> <a id="1677" class="Symbol">→</a> <a id="1679" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a><a id="1683" class="Symbol">}</a>
  <a id="1687" class="Symbol">→</a> <a id="1689" href="Class.Monad.Utils.html#1656" class="Bound">mx</a> <a id="1692" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1694" href="Agda.Builtin.Maybe.html#174" class="InductiveConstructor">just</a> <a id="1699" href="Class.Monad.Utils.html#1648" class="Bound">x</a>
  <a id="1703" class="Symbol">→</a> <a id="1705" href="Class.Monad.Utils.html#1671" class="Bound">f</a> <a id="1707" href="Class.Monad.Utils.html#1648" class="Bound">x</a> <a id="1709" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1711" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>
  <a id="1718" class="Symbol">→</a> <a id="1720" href="Data.Maybe.Base.html#1632" class="Function">fromMaybe</a> <a id="1730" href="Agda.Builtin.Bool.html#182" class="InductiveConstructor">false</a> <a id="1736" class="Symbol">(</a><a id="1737" href="Class.Monad.Utils.html#1656" class="Bound">mx</a> <a id="1740" href="Class.Monad.Core.html#777" class="Field Operator">&gt;&gt;=</a> <a id="1744" href="Class.Applicative.Core.html#955" class="Field">pure</a> <a id="1749" href="Function.Base.html#1031" class="Function Operator">∘</a> <a id="1751" href="Class.Monad.Utils.html#1671" class="Bound">f</a><a id="1752" class="Symbol">)</a> <a id="1754" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">≡</a> <a id="1756" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a>
<a id="1761" href="Class.Monad.Utils.html#1622" class="Function">do-pure</a> <a id="1769" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a> <a id="1774" href="Class.Monad.Utils.html#1774" class="Bound">f≡</a> <a id="1777" class="Keyword">rewrite</a> <a id="1785" href="Class.Monad.Utils.html#1774" class="Bound">f≡</a> <a id="1788" class="Symbol">=</a> <a id="1790" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a>
</pre></body></html>